@BIOCHARA_SHOP
#DIM CHARANUM_LAST_ITEM
CHARANUM_LAST_ITEM = CHARANUM_START_ITEM + TOTAL_CHARANUM

WHILE RESULT != 0
    DRAWLINEFORM =
    CALL SET_BIO_SALES(CHARANUM_START_ITEM, CHARANUM_LAST_ITEM)

    CALL SHOW_SALES_LIST(CHARANUM_START_ITEM, CHARANUM_LAST_ITEM)
    PRINTL
    PRINTL
    PRINTFORML [0] 돌아간다
    PRINTL
    DRAWLINE
    INPUT
    IF RESULT == 0
    ELSEIF ITEMSALES:(RESULT + CHARANUM_START_ITEM) <= 0
        PRINTW 이미 구매한 이력이 있는 바이오로이드입니다.
    ELSEIF EXISTCSV(RESULT)
        CALL BIO_BUY(RESULT)
    ENDIF
WEND

;ARG = ITEM 내 캐릭터번호 시작, ARG:1 = ITEM 내 캐릭터번호 종료
@SET_BIO_SALES(ARG, ARG:1)
FOR LOCAL, ARG, ARG:1
    COUNT = 1
    LOCAL:1 = LOCAL - ARG
    IF GETCHARA(LOCAL:1) != -1
        IF ITEMNAME:LOCAL == ""
            CONTINUE
        ELSEIF ITEM:LOCAL == -1 ;이미 구매한 적 있음
            CONTINUE
        ENDIF
        ITEMSALES:LOCAL = 1
    ENDIF
    COUNT ++
NEXT

@BIO_BUY(ARG)
#DIM C_ITEMID
#DIM R_ID

C_ITEMID = ARG + CHARANUM_START_ITEM
R_ID = GETCHARA(ARG)

CLEARLINE 1
PRINTL
CALL BIO_INFO(R_ID)
MONEYSTR ITEMPRICE:C_ITEMID
PRINTFORML 가격: %RESULTS%

PRINTL 구매하시겠습니까?
CALL ASK_YN
IF RESULT == 0
    IF MONEY:0 < ITEMPRICE:C_ITEMID
        PRINTW 돈이 부족합니다.
        RETURN 1
    ELSEIF ITEM:C_ITEMID > 0
        PRINTW 이미 보유중인 바이오로이드입니다.
        RETURN 1
    ELSEIF FLAG:캐릭터보유고 <= FLAG:현캐릭터수
        PRINTW 공간이 부족합니다.
        RETURN 1
    ENDIF
    MONEY:0 -= ITEMPRICE:C_ITEMID
    ITEM:C_ITEMID = 1
    FLAG:현캐릭터수 ++
    ITEMSALES:C_ITEMID = 0
    PRINTFORMW %캐릭터를% 구매하였습니다.
ELSE
    PRINTW 구매하지 않았습니다.
    RETURN 1
ENDIF
